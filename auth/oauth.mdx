---
title: "OAuth Provider Setup"
description: "Configure OAuth authentication with GitHub, Google, and Microsoft for social login in Quackback"
icon: "key"
---

# OAuth Provider Setup

Quackback supports OAuth authentication with GitHub, Google, and Microsoft for both portal users and team members. This guide covers how to configure each provider.

## Overview

OAuth allows users to sign in using their existing accounts from trusted providers, eliminating the need for separate passwords.

### Supported Providers

| Provider | Portal Users | Team Members | Configuration |
|----------|--------------|--------------|---------------|
| GitHub | Yes | Yes | Environment variables |
| Google | Yes | Yes | Environment variables |
| Microsoft | Yes | Yes | Environment variables |

### How It Works

1. User clicks "Continue with [Provider]"
2. A popup window opens to the provider's login page
3. User authenticates and grants permission
4. Provider redirects back to Quackback with authorization code
5. Quackback exchanges the code for user information
6. User session is created

## GitHub Setup

### Step 1: Create OAuth Application

1. Go to [GitHub Developer Settings](https://github.com/settings/developers)
2. Click **OAuth Apps** > **New OAuth App**
3. Fill in the application details:

| Field | Value |
|-------|-------|
| Application name | `Quackback` (or your custom name) |
| Homepage URL | `https://feedback.yourcompany.com` |
| Authorization callback URL | `https://feedback.yourcompany.com/api/auth/callback/github` |

4. Click **Register application**
5. Note the **Client ID**
6. Click **Generate a new client secret** and save it securely

### Step 2: Configure Environment

Add to your `.env` file:

```bash
GITHUB_CLIENT_ID="your-client-id"
GITHUB_CLIENT_SECRET="your-client-secret"
```

### Callback URL Format

```
https://YOUR_DOMAIN/api/auth/callback/github
```

For local development:
```
http://localhost:3000/api/auth/callback/github
```

### Scopes Requested

- `read:user` - Read user profile information
- `user:email` - Access user email addresses

## Google Setup

### Step 1: Create OAuth Credentials

1. Go to [Google Cloud Console](https://console.cloud.google.com/)
2. Create a new project or select an existing one
3. Navigate to **APIs & Services** > **Credentials**
4. Click **Create Credentials** > **OAuth client ID**
5. If prompted, configure the OAuth consent screen first:
   - User Type: **External** (or Internal for Workspace)
   - App name: `Quackback`
   - User support email: Your email
   - Authorized domains: `yourcompany.com`

### Step 2: Configure OAuth Client

1. Application type: **Web application**
2. Name: `Quackback`
3. Authorized JavaScript origins:
   ```
   https://feedback.yourcompany.com
   ```
4. Authorized redirect URIs:
   ```
   https://feedback.yourcompany.com/api/auth/callback/google
   ```
5. Click **Create**
6. Note the **Client ID** and **Client Secret**

### Step 3: Configure Environment

```bash
GOOGLE_CLIENT_ID="your-client-id.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="your-client-secret"
```

### Callback URL Format

```
https://YOUR_DOMAIN/api/auth/callback/google
```

### Scopes Requested

- `openid` - OpenID Connect authentication
- `email` - User email address
- `profile` - Basic profile information

## Microsoft / Azure AD Setup

### Step 1: Register Application

1. Go to [Azure Portal](https://portal.azure.com/)
2. Navigate to **Microsoft Entra ID** (formerly Azure AD)
3. Go to **App registrations** > **New registration**
4. Configure the application:

| Field | Value |
|-------|-------|
| Name | `Quackback` |
| Supported account types | Choose based on your needs* |
| Redirect URI | Web: `https://feedback.yourcompany.com/api/auth/callback/microsoft` |

*Account type options:
- **Single tenant** - Only your organization
- **Multitenant** - Any Microsoft work/school account
- **Multitenant + personal** - Work, school, and personal Microsoft accounts

### Step 2: Configure Client Secret

1. Go to **Certificates & secrets**
2. Click **New client secret**
3. Add a description and expiration
4. Copy the **Value** (shown only once)

### Step 3: Note Application IDs

From the **Overview** page:
- **Application (client) ID** - This is your `MICROSOFT_CLIENT_ID`
- **Directory (tenant) ID** - This is your `MICROSOFT_TENANT_ID`

### Step 4: Configure Environment

```bash
MICROSOFT_CLIENT_ID="your-application-id"
MICROSOFT_CLIENT_SECRET="your-client-secret-value"
MICROSOFT_TENANT_ID="your-tenant-id"  # Or "common" for multi-tenant
```

### Tenant ID Options

| Value | Description |
|-------|-------------|
| `your-tenant-id` | Single organization only |
| `common` | Any Microsoft account |
| `organizations` | Work/school accounts only |
| `consumers` | Personal Microsoft accounts only |

### Callback URL Format

```
https://YOUR_DOMAIN/api/auth/callback/microsoft
```

## Enabling OAuth in Quackback

After configuring environment variables, OAuth providers are automatically available. To enable/disable them for portal users:

### Admin Settings

1. Navigate to **Admin > Settings > Authentication**
2. Under **Portal Authentication**, toggle the providers:
   - **GitHub** - Enable/disable GitHub sign-in
   - **Google** - Enable/disable Google sign-in

### Environment-Based Control

OAuth buttons only appear if the corresponding environment variables are set. To disable a provider entirely, remove its environment variables.

## Custom OIDC Provider

For identity providers not listed above, Quackback supports custom OpenID Connect (OIDC) configuration.

### Supported Providers

Any OIDC-compliant provider works:
- Okta
- Auth0
- Keycloak
- OneLogin
- Azure AD B2C
- Custom OIDC servers

### Configuration

1. Navigate to **Admin > Settings > Authentication**
2. Click the gear icon next to **Custom OpenID Connect**
3. Fill in the configuration:

| Field | Description | Example |
|-------|-------------|---------|
| Button Label | Text shown on login button | "Acme Corp SSO" |
| Issuer URL | OIDC discovery endpoint base | `https://acme.okta.com` |
| Client ID | OAuth client identifier | `0oa1234567890abcdef` |
| Client Secret | OAuth client secret | `secret_...` |
| Email Domain | Optional domain restriction | `acme.com` |

4. Click **Test** to verify the issuer URL
5. Click **Save & Enable**

### Callback URL for OIDC

```
https://YOUR_DOMAIN/api/auth/callback/oidc
```

## Common Issues

### "OAuth callback URL mismatch"

The callback URL in your OAuth app configuration must match exactly:

**Check these common issues:**
- Protocol mismatch (`http` vs `https`)
- Trailing slash differences
- Port number missing or incorrect
- Domain/subdomain mismatch

**Example correct callback URLs:**
```
# Production
https://feedback.yourcompany.com/api/auth/callback/github

# Local development
http://localhost:3000/api/auth/callback/github
```

### "Invalid client_id or client_secret"

1. Verify the credentials are copied correctly (no extra spaces)
2. Ensure the OAuth app is not deleted or disabled
3. For Google, check if the OAuth consent screen is in testing mode
4. For Microsoft, verify the client secret hasn't expired

### "Popup blocked"

Quackback uses popup windows for OAuth. If blocked:

1. Click the browser's popup blocked notification
2. Allow popups for your Quackback domain
3. Try the sign-in again

### "Access denied" or "Application not authorized"

**GitHub:**
- Verify the OAuth app is not suspended
- Check organization access policies

**Google:**
- If consent screen is in testing mode, add test users
- Submit app for verification for production use
- Check if domain restrictions apply

**Microsoft:**
- Verify tenant ID matches your configuration
- Check if admin consent is required
- Review enterprise application policies

### "Unable to get email from provider"

Some providers don't return email by default:

**GitHub:**
- User must have a public email or grant email permission
- Quackback fetches from `/user/emails` as fallback

**Google:**
- Email scope is always requested
- User must have a Google account with email

### CORS Errors

If you see CORS errors in the browser console:

1. Verify `ROOT_URL` matches your actual domain
2. Check `BETTER_AUTH_URL` is correctly set
3. Ensure your reverse proxy passes the correct headers

## Security Best Practices

### Protect Client Secrets

- Never commit secrets to version control
- Use environment variables or secret management
- Rotate secrets periodically
- Use separate OAuth apps for development/production

### Verify Callback URLs

- Use HTTPS in production
- Don't use wildcard callback URLs
- Restrict to your exact domain

### Review OAuth Permissions

Each provider requests minimal scopes:
- Basic profile information
- Email address (for account identification)

No write access or sensitive permissions are requested.

### Monitor OAuth Activity

- Review sign-in logs regularly
- Set up alerts for unusual patterns
- Disable unused OAuth providers

## Environment Variables Reference

```bash
# GitHub
GITHUB_CLIENT_ID=""
GITHUB_CLIENT_SECRET=""

# Google
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""

# Microsoft
MICROSOFT_CLIENT_ID=""
MICROSOFT_CLIENT_SECRET=""
MICROSOFT_TENANT_ID="common"

# Required for all OAuth
BETTER_AUTH_SECRET=""
BETTER_AUTH_URL=""
ROOT_URL=""
```

## Testing OAuth Locally

### Local Development Setup

1. Use `localhost:3000` as your callback URL
2. Most providers allow `http://localhost` for development
3. For Google, add `http://localhost:3000` to authorized origins

### Testing Checklist

- [ ] OAuth app created with correct callback URL
- [ ] Environment variables set in `.env`
- [ ] Quackback server restarted after env changes
- [ ] Browser allows popups from your domain
- [ ] Test user exists (for testing-mode apps)

## Related Documentation

- [Email OTP](/auth/email-otp) - Magic code authentication
- [SSO](/auth/sso) - Enterprise SAML/OIDC for teams
- [Authentication Overview](/auth/overview) - General auth concepts
