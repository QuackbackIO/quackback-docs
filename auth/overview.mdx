---
title: "Authentication"
description: "Passwordless authentication with email codes and OAuth."
icon: "lock"
---

# Authentication

Quackback supports multiple sign-in methods: email and password, passwordless email codes (OTP), and OAuth providers. Choose the combination that fits your users.

## Authentication Flows

Quackback has two distinct authentication systems for different audiences:

| Audience | Who | Settings Location |
|----------|-----|-------------------|
| **Portal Users** | Customers who submit feedback | [Admin → Settings → Portal Authentication](/admin/portal-auth) |
| **Team Members** | Employees who manage feedback | [Admin → Settings → Security](/admin/security) |

### Portal Users

Regular users who submit and vote on feedback:

| Method | Description | Default |
|--------|-------------|---------|
| Password | Email and password sign-in | Enabled |
| Email OTP | 6-digit code sent to email | Disabled |
| OAuth | GitHub, Google | Enabled |

Configure in: **[Admin → Settings → Portal Authentication](/admin/portal-auth)**

### Team Members

Admins and staff who manage feedback in the admin dashboard:

| Method | Description |
|--------|-------------|
| Password | Email and password sign-in |
| Email OTP | 6-digit code sent to email |
| OAuth | GitHub, Google |

Configure in: **[Admin → Settings → Security](/admin/security)**

## Quick Setup

### Minimal Configuration

```bash
# Required
SECRET_KEY="your-32-char-secret"  # openssl rand -base64 32
BASE_URL="https://feedback.yourcompany.com"
```

With just these settings:
- Password sign-in works for all users
- Email OTP is available if enabled (codes print to console without email configured)

### With Email Delivery

```bash
# SMTP
EMAIL_SMTP_HOST="smtp.sendgrid.net"
EMAIL_SMTP_PORT="587"
EMAIL_SMTP_USER="apikey"
EMAIL_SMTP_PASS="your-api-key"
EMAIL_FROM="feedback@yourcompany.com"
```

## OAuth Providers

### GitHub

1. Create OAuth App at [GitHub Developer Settings](https://github.com/settings/developers)
2. Set callback URL: `https://your-domain.com/api/auth/callback/github`
3. Add to `.env`:

```bash
GITHUB_CLIENT_ID="your-client-id"
GITHUB_CLIENT_SECRET="your-client-secret"
```

### Google

1. Create credentials at [Google Cloud Console](https://console.cloud.google.com/apis/credentials)
2. Set authorized redirect URI: `https://your-domain.com/api/auth/callback/google`
3. Add to `.env`:

```bash
GOOGLE_CLIENT_ID="your-client-id"
GOOGLE_CLIENT_SECRET="your-client-secret"
```

## Sessions

### Session Duration

- Default: 7 days
- Refreshed every 24 hours on activity
- Invalidated on logout

### Session Storage

Sessions are stored in PostgreSQL:
- `session` table for active sessions
- Automatic cleanup of expired sessions

## Roles & Permissions

### Portal User

- Submit feedback
- Vote on posts
- Comment on posts
- Manage notifications

### Team Member

- All portal user permissions
- Access admin dashboard
- Manage feedback
- Change post statuses

### Admin

- All member permissions
- Workspace settings
- Team management
- Integration configuration

## Security Features

### CSRF Protection

Better Auth provides automatic CSRF protection using trusted origin validation. The application dynamically trusts origins based on the request host.

### OTP Settings

- OTP code length: 6 digits
- OTP expiration: 10 minutes
- Magic link expiration: 7 days (used for team member invitations)

<Warning>
Rate limiting for authentication is not currently implemented at the application level. The resend cooldown (60 seconds) is enforced client-side only. Consider using a reverse proxy (nginx, Cloudflare) for rate limiting in production.
</Warning>

## Customization

### Portal Authentication

Control what sign-in methods are available to portal users (customers):

1. Go to **Admin → Settings → Portal Authentication**
2. Toggle methods on/off (Password, Email OTP, GitHub, Google)

See [Portal Authentication](/admin/portal-auth) for details.

### Team Authentication

Control what sign-in methods are available to team members (employees):

1. Go to **Admin → Settings → Security**
2. Toggle methods on/off (Password, Email OTP, GitHub, Google)

See [Security](/admin/security) for details.

## Troubleshooting

### "Invalid session" errors

1. Clear browser cookies
2. Try incognito mode
3. Check `BASE_URL` matches your domain

### OTP not received

1. Check spam folder
2. Verify email configuration
3. Check console for OTP in development

### OAuth redirect errors

1. Verify callback URL matches exactly
2. Check client ID and secret
3. Ensure provider is properly configured

## Next Steps

- [Email OTP](/auth/email-otp) - Email code setup
- [OAuth](/auth/oauth) - Social login configuration
