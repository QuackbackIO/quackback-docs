---
title: "Authentication"
description: "Passwordless authentication with email codes, OAuth, and OIDC."
icon: "lock"
---

# Authentication

No more password resets. Quackback uses passwordless authentication (email codes, OAuth, or OIDC) so users sign in quickly and securely without another password to forget.

## Authentication Flows

Quackback has two distinct authentication systems for different audiences:

| Audience | Who | Settings Location |
|----------|-----|-------------------|
| **Portal Users** | Customers who submit feedback | [Admin → Settings → Portal Authentication](/admin/portal-auth) |
| **Team Members** | Employees who manage feedback | [Admin → Settings → Security](/admin/security) |

### Portal Users

Regular users who submit and vote on feedback:

| Method | Description |
|--------|-------------|
| Email OTP | 6-digit code sent to email |
| OAuth | GitHub, Google |
| OIDC | Custom OpenID Connect identity provider |

Configure in: **[Admin → Settings → Portal Authentication](/admin/portal-auth)**

### Team Members

Admins and staff who manage feedback in the admin dashboard:

| Method | Description |
|--------|-------------|
| Email OTP | 6-digit code sent to email (password auth is disabled) |
| OAuth | GitHub, Google |
| OIDC SSO | Connect to your identity provider |

Configure in: **[Admin → Settings → Security](/admin/security)**

<Note>
Password-based authentication is disabled. All authentication uses passwordless methods (OTP codes or OAuth).
</Note>

## Quick Setup

### Minimal Configuration

```bash
# Required
SECRET_KEY="your-32-char-secret"  # openssl rand -base64 32
BASE_URL="https://feedback.yourcompany.com"
```

With just these settings:
- Email OTP works for all users
- OTP codes print to console (configure email for production)

### With Email Delivery

```bash
# SMTP
EMAIL_SMTP_HOST="smtp.sendgrid.net"
EMAIL_SMTP_PORT="587"
EMAIL_SMTP_USER="apikey"
EMAIL_SMTP_PASS="your-api-key"
EMAIL_FROM="feedback@yourcompany.com"
```

## OAuth Providers

### GitHub

1. Create OAuth App at [GitHub Developer Settings](https://github.com/settings/developers)
2. Set callback URL: `https://your-domain.com/api/auth/oauth/github`
3. Add to `.env`:

```bash
GITHUB_CLIENT_ID="your-client-id"
GITHUB_CLIENT_SECRET="your-client-secret"
```

### Google

1. Create credentials at [Google Cloud Console](https://console.cloud.google.com/apis/credentials)
2. Set authorized redirect URI: `https://your-domain.com/api/auth/oauth/google`
3. Add to `.env`:

```bash
GOOGLE_CLIENT_ID="your-client-id"
GOOGLE_CLIENT_SECRET="your-client-secret"
```

<Note>
Microsoft OAuth is not currently supported.
</Note>

## Sessions

### Session Duration

- Default: 7 days
- Refreshed every 24 hours on activity
- Invalidated on logout

### Session Storage

Sessions are stored in PostgreSQL:
- `sessions` table for active sessions
- Automatic cleanup of expired sessions

## Roles & Permissions

### Portal User

- Submit feedback
- Vote on posts
- Comment on posts
- Manage notifications

### Team Member

- All portal user permissions
- Access admin dashboard
- Manage feedback
- Change post statuses

### Admin

- All member permissions
- Workspace settings
- Team management
- Integration configuration

## Security Features

### CSRF Protection

Better Auth provides automatic CSRF protection using trusted origin validation. The application dynamically trusts origins based on the request host.

### OTP Settings

- OTP code length: 6 digits
- OTP expiration: 10 minutes
- Magic link expiration: 7 days (used for invitations)

<Warning>
Rate limiting is not currently implemented at the application level. Consider using a reverse proxy (nginx, Cloudflare) for rate limiting in production.
</Warning>

## Customization

### Portal Authentication

Control what sign-in methods are available to portal users (customers):

1. Go to **Admin → Settings → Portal Authentication**
2. Toggle methods on/off (Email, GitHub, Google, OIDC)
3. Configure custom OIDC if needed

See [Portal Authentication](/admin/portal-auth) for details.

### Team Authentication

Control what sign-in methods are available to team members (employees):

1. Go to **Admin → Settings → Security**
2. Toggle methods on/off (Email, GitHub, Google)
3. Configure OIDC if needed

See [Security](/admin/security) for details.

## Troubleshooting

### "Invalid session" errors

1. Clear browser cookies
2. Try incognito mode
3. Check `BASE_URL` matches your domain

### OTP not received

1. Check spam folder
2. Verify email configuration
3. Check console for OTP in development

### OAuth redirect errors

1. Verify callback URL matches exactly
2. Check client ID and secret
3. Ensure provider is properly configured

## Next Steps

- [Email OTP](/auth/email-otp) - Magic link setup
- [OAuth](/auth/oauth) - Social login configuration
- [SSO](/auth/sso) - OIDC Single Sign-On
